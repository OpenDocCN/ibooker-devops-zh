# 序言

服务网格需要一点声誉修复。

许多云原生从业者似乎认为网格是可怕的、复杂的东西，是应该避免的，直到作为拯救濒临崩溃的应用程序的最后手段进行检查。我们希望改变这种看法：服务网格是使开发和运营云原生应用程序变得比以往更容易的不可思议的工具。

当然，我们认为 Linkerd 是目前最好的服务网格，可以让事情变得更容易。

所以，如果你一直在试图通过日志理解一个行为异常的应用程序而感到抓狂，或者如果你花了几个月时间尝试让其他的服务网格运行起来，*只是想让事情正常运转*，或者如果你正在尝试向另一个开发人员解释为什么他们真的不需要担心在他们的微服务中编写重试和 mTLS，那么你来对地方了。我们很高兴你在这里。

# 谁应该阅读这本书

这本书旨在帮助任何认为在创建、运行或调试微服务应用程序时，通过 Linkerd 可以更轻松地完成任务的人。虽然我们认为这本书将使对 Linkerd 感兴趣的人受益，但 Linkerd —— 就像计算本身一样 —— 最终是一种手段，而不是目的。这本书体现了这一点。

除此之外，对于我们来说，无论你是应用程序开发人员、集群操作员、平台工程师还是其他任何角色；这本书都应该有助于帮助你充分利用 Linkerd。我们的目标是为你提供一切你需要的东西，让 Linkerd 运行起来，帮助你完成任务。

你需要一些关于 Kubernetes 的基础知识，关于在容器中运行事物的整体概念，以及 Unix 命令行，才能充分利用本书。对 Prometheus、Helm、Jaeger 等工具有一定了解也会有所帮助，但并不是必须的。

# 为什么我们写这本书

我们两个在云原生领域工作多年，在那之前在软件领域工作了更多年。在所有这段时间里，从未消失的挑战是教育；新潮的东西并不是很有用，直到人们真正理解它是什么以及如何使用它。

现在应该对服务网格有相当深入的了解了，但当然每个月都会有人需要解决网格中最新和最伟大的变化，每个月都会有更多的人迁移到对他们来说完全新的云原生世界。我们写这本书，并将继续更新它，以帮助所有这些人。

# 导读本书

第一章，“服务网格 101”，是关于服务网格的介绍：它们的作用，它们可以帮助解决的问题，以及为什么你可能想要使用它们。对于不熟悉服务网格的人来说，这是必读的。

第二章，“Linkerd 简介”，深入探讨了 Linkerd 的架构和历史。如果你已经熟悉 Linkerd，这可能大部分是回顾。

第三章，“部署 Linkerd”，以及第四章，“向网格添加工作负载”，讨论如何在集群中运行 Linkerd，并让你的应用与 Linkerd 协同工作。这两章涵盖了实际*使用*Linkerd 的基本要点。第五章，“入口和 Linkerd”，接着讨论入口问题，如何管理以及 Linkerd 如何与入口控制器交互。

第六章，“Linkerd CLI”，讨论了`linkerd` CLI，你可以使用它来控制和检查 Linkerd 部署。

第七章，“mTLS、Linkerd 和证书”，深入探讨了 Linkerd mTLS 以及它如何使用 X.509 证书。第八章，“Linkerd 策略：概述和基于服务器的策略”，和第九章，“Linkerd 基于路由的策略”，继续探讨 Linkerd 如何使用这些 mTLS 身份在您的集群中强制执行策略。

第十章，“使用 Linkerd 观察您的平台”，全面探讨了 Linkerd 的应用程序级可观察性机制。第十一章，“使用 Linkerd 确保可靠性”，反过来，涵盖了如何使用 Linkerd 提高应用程序的可靠性，而第十二章，“Linkerd 跨多个 Kubernetes 集群进行通信”，则讨论了如何在多个 Kubernetes 集群之间扩展 Linkerd 网格。

第十三章，“Linkerd CNI 与 Init 容器”，讨论了 Linkerd 如何与集群的低级网络配置交互的棘手话题。不幸的是，这可能是讨论的必要话题，因为你考虑将 Linkerd 投入生产，这是第十四章，“生产就绪的 Linkerd”的主题。

最后，第十五章，“调试 Linkerd”，讨论了如何调试 Linkerd 本身，如果发现问题（尽管我们希望你不会！）。

# 本书使用的约定

本书使用以下排版约定：

*斜体*

表示新术语、URL、电子邮件地址、文件名和文件扩展名。

`固定宽度`

用于程序清单，以及在段落内引用程序元素，如变量或函数名、数据库、数据类型、环境变量、语句和关键字。

*`固定宽度斜体`*

显示应该用用户提供的值或由上下文确定的值替换的文本。

###### 注意

这个元素表示一般性说明。

###### 警告

这个元素表示警告或注意事项。

# 使用代码示例

补充材料（代码示例、练习等）可在[*https://oreil.ly/linkerd-code*](https://oreil.ly/linkerd-code)下载。

如果您有技术问题或在使用代码示例时遇到问题，请发送电子邮件至*support@oreilly.com*。

本书旨在帮助您完成工作。一般来说，如果本书附有示例代码，则您可以在程序和文档中使用它。除非您复制了大量代码的重要部分，否则无需联系我们请求许可。例如，编写一个使用本书中几个代码块的程序不需要许可。销售或分发 O’Reilly 图书中的示例代码则需要许可。引用本书并引用示例代码回答问题不需要许可。将本书中大量示例代码整合到您产品的文档中则需要许可。

我们感激，但通常不需要署名。署名通常包括标题、作者、出版商和 ISBN。例如：“*Linkerd: Up and Running* by Jason Morgan and Flynn (O’Reilly). Copyright 2024 Jason Morgan and Kevin Hood, 978-1-098-14231-5.”

如果您觉得您使用的代码示例超出了公平使用范围或上述许可，请随时通过*permissions@oreilly.com*与我们联系。

# O’Reilly 在线学习

###### 注意

40 多年来，[*O’Reilly Media*](https://oreilly.com)一直为企业提供技术和商业培训、知识和见解，帮助它们取得成功。

我们独特的专家和创新者网络通过书籍、文章以及我们的在线学习平台分享他们的知识和专业知识。O’Reilly 的在线学习平台为您提供按需访问实时培训课程、深入学习路径、交互式编码环境以及来自 O’Reilly 和其他 200 多家出版商的大量文本和视频。欲了解更多信息，请访问[*https://oreilly.com*](https://oreilly.com)。

# 如何联系我们

请将有关此书的评论和问题寄给出版商：

+   O’Reilly Media, Inc.

+   1005 Gravenstein Highway North

+   Sebastopol, CA 95472

+   800-889-8969（美国或加拿大）

+   707-827-7019（国际或当地）

+   707-829-0104（传真）

+   *support@oreilly.com*

+   [*https://www.oreilly.com/about/contact.html*](https://www.oreilly.com/about/contact.html)

我们为这本书设有网页，列出勘误、示例和任何额外信息。您可以访问[*https://oreil.ly/linkerd-up-and-running*](https://oreil.ly/linkerd-up-and-running)。

有关我们的图书和课程的新闻和信息，请访问[*https://oreilly.com*](https://oreilly.com)。

在 LinkedIn 上找到我们：[*https://linkedin.com/company/oreilly-media*](https://linkedin.com/company/oreilly-media)

在 YouTube 上观看我们：[*https://youtube.com/oreillymedia*](https://youtube.com/oreillymedia)

# 致谢

非常感谢所有帮助我们开发这本书的朋友们，包括（但不限于！）：

+   我们的编辑 Angela Rufino。

+   技术审阅员 Daniel Bryant、Ben Muschko 和 Swapnil Shevate，他们提供了令人惊叹的反馈，使这本书变得更加完善。

+   O'Reilly 的无名英雄们使一切都成为可出版的形式。

+   最后但同样重要的是，Linkerd 的维护者们以及创建我们正在撰写的内容的 Buoyant 公司的优秀人才。

Flynn 要向 SC 和 RAH 大声喊出感谢，在这一年的努力中，他们一直陪伴着他。非常感谢。
